{"version":3,"file":"index.js","sources":["../node_modules/atomico/src/core/constants.js","../node_modules/atomico/src/core/utils.js","../node_modules/atomico/src/core/hooks.js","../node_modules/atomico/src/core/render/diff-props.js","../node_modules/atomico/src/core/vnode.js","../node_modules/atomico/src/core/render/diff.js","../node_modules/atomico/src/core/render/render.js","../node_modules/atomico/src/core/element/utils.js","../node_modules/atomico/src/core/task.js","../node_modules/atomico/src/core/element/element.js","../src/index.js"],"sourcesContent":["export const HOOK_MOUNT = Symbol(\"mount\");\r\nexport const HOOK_MOUNTED = Symbol(\"mounted\");\r\nexport const HOOK_UPDATE = Symbol(\"update\");\r\nexport const HOOK_UPDATED = Symbol(\"updated\");\r\nexport const HOOK_UNMOUNT = Symbol(\"unmount\");\r\nexport const HOOK_CURRENT = {};\r\n\r\nexport const ELEMENT_PROPS = Symbol(\"props\");\r\nexport const ELEMENT_IGNORE_ATTR = Symbol(\"ignore\");\r\nexport const ELEMENT_TRUE_VALUES = [true, 1, \"\", \"1\", \"true\"];\r\n\r\nexport const ARRAY_EMPTY = [];\r\n\r\nexport const NODE_TYPE = \"localName\";\r\n\r\nexport const KEY = Symbol(\"key\");\r\n\r\nexport const META_STYLE_SHEET = Symbol(\"styleSheet\");\r\n\r\nexport const META_MAP_CHILDREN = Symbol(\"mapChildren\");\r\n\r\nexport const META_KEYES = Symbol(\"keyes\");\r\n\r\nexport const NODE_HOST = \"host\";\r\n\r\nexport const IGNORE_CHILDREN = {\r\n    innerHTML: 1,\r\n    textContent: 1,\r\n    contenteditable: 1\r\n};\r\n\r\nexport const HYDRATE_PROPS = {\r\n    className: 1,\r\n    id: 1,\r\n    checked: 1,\r\n    value: 1,\r\n    selected: 1\r\n};\r\n\r\nexport const CACHE_STYLE_SHEET = {};\r\n\r\nexport const SUPPORT_STYLE_SHEET = \"adoptedStyleSheets\" in document;\r\n\r\nexport const STYLE_SHEET_KEY = Symbol();\r\n","/**\r\n * Return if value is array\r\n * @param {*}\r\n * @return {boolean}\r\n */\r\nexport function isArray(value) {\r\n    return Array.isArray(value);\r\n}\r\n/**\r\n * compare 2 array\r\n * @param {array} before\r\n * @param {array} after\r\n * @example\r\n * isEqualArray([1,2,3,4],[1,2,3,4]) // true\r\n * isEqualArray([1,2,3,4],[1,2,3])   // false\r\n * isEqualArray([5,1,2,3],[1,2,3,5]) // false\r\n * isEqualArray([],[]) // true\r\n * @returns {boolean}\r\n */\r\nexport function isEqualArray(before, after) {\r\n    let length = before.length;\r\n    if (length !== after.length) return false;\r\n    for (let i = 0; i < length; i++) {\r\n        if (before[i] !== after[i]) return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function assign(master, commit) {\r\n    for (let key in commit) {\r\n        master[key] = commit[key];\r\n    }\r\n    for (let i = 2; i < arguments.length; i++) assign(master, arguments[i]);\r\n    return master;\r\n}\r\n\r\nexport function isFunction(value) {\r\n    return typeof value == \"function\";\r\n}\r\n\r\n// export function fps(callback, count = 3) {\r\n//     count-- ? requestAnimationFrame(() => fps(callback, count)) : callback();\r\n// }\r\n\r\nexport function promise(callback) {\r\n    return new Promise(callback);\r\n}\r\n","import {\r\n    HOOK_MOUNT,\r\n    HOOK_UPDATE,\r\n    HOOK_CURRENT,\r\n    HOOK_MOUNTED,\r\n    HOOK_UPDATED,\r\n    HOOK_UNMOUNT,\r\n    ARRAY_EMPTY\r\n} from \"./constants\";\r\nimport { isFunction, isEqualArray } from \"./utils\";\r\n\r\nfunction update(hook, type) {\r\n    hook[0] && (hook[1] = hook[0](hook[1], type));\r\n}\r\n\r\nfunction updateAll(hooks, type) {\r\n    for (let i in hooks) update(hooks[i], type);\r\n}\r\n\r\nexport function useHook(reducer, initialState) {\r\n    if (HOOK_CURRENT.ref.hook) {\r\n        return HOOK_CURRENT.ref.hook.use(reducer, initialState)[1];\r\n    }\r\n}\r\n\r\nexport function useRender() {\r\n    return HOOK_CURRENT.ref.render;\r\n}\r\n\r\nexport function useHost() {\r\n    return useHook(0, { current: HOOK_CURRENT.ref.host });\r\n}\r\n\r\nexport function createHookCollection(render, host) {\r\n    let hooks = {};\r\n    let mounted;\r\n    let hook = {\r\n        use,\r\n        load,\r\n        updated,\r\n        unmount\r\n    };\r\n\r\n    let ref = { hook, host, render };\r\n\r\n    function load(callback, param) {\r\n        HOOK_CURRENT.index = 0;\r\n        HOOK_CURRENT.ref = ref;\r\n        let resolve = callback(param);\r\n        HOOK_CURRENT.ref = 0;\r\n        return resolve;\r\n    }\r\n    function use(reducer, state) {\r\n        let index = HOOK_CURRENT.index++;\r\n        let mount;\r\n        // record the hook and the initial state of this\r\n        if (!hooks[index]) {\r\n            hooks[index] = [null, state];\r\n            mount = 1;\r\n        }\r\n        // The hook always receives the last reduce.\r\n        hooks[index][0] = reducer;\r\n        update(hooks[index], mount ? HOOK_MOUNT : HOOK_UPDATE);\r\n        return hooks[index];\r\n    }\r\n    function updated() {\r\n        let type = mounted ? HOOK_UPDATED : HOOK_MOUNTED;\r\n        mounted = 1;\r\n        updateAll(hooks, type);\r\n    }\r\n    function unmount() {\r\n        updateAll(hooks, HOOK_UNMOUNT);\r\n    }\r\n    return hook;\r\n}\r\n\r\nexport function useState(initialState) {\r\n    let render = useRender();\r\n    return useHook((state, type) => {\r\n        if (HOOK_MOUNT == type) {\r\n            state[0] = isFunction(initialState) ? initialState() : initialState;\r\n            state[1] = nextState => {\r\n                nextState = isFunction(nextState)\r\n                    ? nextState(state[0])\r\n                    : nextState;\r\n                if (nextState != state[0]) {\r\n                    state[0] = nextState;\r\n                    render();\r\n                }\r\n            };\r\n        }\r\n        return state;\r\n    }, []);\r\n}\r\n\r\nexport function useEffect(callback, args) {\r\n    // define whether the effect in the render cycle should be regenerated\r\n    let executeEffect;\r\n    useHook((state, type) => {\r\n        if (executeEffect == null) {\r\n            executeEffect =\r\n                args && state[0] ? !isEqualArray(args, state[0]) : true;\r\n            state[0] = args;\r\n        }\r\n\r\n        switch (type) {\r\n            case HOOK_UPDATE:\r\n            case HOOK_UNMOUNT:\r\n                // save the current args, for comparison\r\n                if ((executeEffect || type == HOOK_UNMOUNT) && state[1]) {\r\n                    // compare the previous snapshot with the generated state\r\n                    state[1]();\r\n                    // clean the effect collector\r\n                    state[1] = 0;\r\n                }\r\n                // delete the previous argument for a hook\r\n                // run if the hook is inserted in a new node\r\n                // Why? ... to perform again dom operations associated with the parent\r\n                if (type == HOOK_UNMOUNT) {\r\n                    state[0] = null;\r\n                }\r\n                break;\r\n            case HOOK_MOUNTED:\r\n            case HOOK_UPDATED:\r\n                // save the current args, for comparison, repeats due to additional type HOOK_MOUNTED\r\n                if (executeEffect || type == HOOK_MOUNTED) {\r\n                    // save the effect collector\r\n                    state[1] = callback();\r\n                }\r\n                // save the comparison argument\r\n                break;\r\n        }\r\n        return state;\r\n    }, []);\r\n}\r\n\r\nexport function useRef(current) {\r\n    return useHook(0, { current });\r\n}\r\n\r\nexport function useMemo(callback, args = ARRAY_EMPTY) {\r\n    let state = useHook(0, []);\r\n\r\n    if (!state[0] || (state[0] && !isEqualArray(state[0], args))) {\r\n        state[1] = callback();\r\n    }\r\n    state[0] = args;\r\n    return state[1];\r\n}\r\n\r\nexport function useReducer(reducer, initialState) {\r\n    let render = useRender();\r\n    let hook = useHook((state, type) => {\r\n        if (HOOK_MOUNT == type) {\r\n            state[0] = initialState;\r\n            state[1] = action => {\r\n                let nextState = state[2](state[0], action);\r\n                if (nextState != state[0]) {\r\n                    state[0] = nextState;\r\n                    render();\r\n                }\r\n            };\r\n        }\r\n        return state;\r\n    }, []);\r\n    // allows the reduce to always access the scope of the component\r\n    hook[2] = reducer;\r\n\r\n    return hook;\r\n}\r\n","import {\r\n    CACHE_STYLE_SHEET,\r\n    IGNORE_CHILDREN,\r\n    HYDRATE_PROPS,\r\n    KEY,\r\n    SUPPORT_STYLE_SHEET\r\n} from \"../constants\";\r\nimport { isFunction } from \"../utils\";\r\n/**\r\n *\r\n * @param {import(\"./render\").HTMLNode} node\r\n * @param {Object} props\r\n * @param {Object} nextProps\r\n * @param {boolean} isSvg\r\n * @param {Object} handlers\r\n **/\r\nexport function diffProps(node, props, nextProps, isSvg, handlers) {\r\n    props = props || {};\r\n\r\n    for (let key in props) {\r\n        if (!(key in nextProps)) {\r\n            setProperty(node, key, props[key], null, isSvg, handlers);\r\n        }\r\n    }\r\n    let ignoreChildren;\r\n    for (let key in nextProps) {\r\n        setProperty(node, key, props[key], nextProps[key], isSvg, handlers);\r\n        ignoreChildren = ignoreChildren || IGNORE_CHILDREN[key];\r\n    }\r\n    return ignoreChildren;\r\n}\r\n\r\nfunction setProperty(node, key, prevValue, nextValue, isSvg, handlers) {\r\n    key = key == \"class\" && !isSvg ? \"className\" : key;\r\n    // define empty value\r\n    prevValue = prevValue == null ? null : prevValue;\r\n    nextValue = nextValue == null ? null : nextValue;\r\n\r\n    if (key in node && HYDRATE_PROPS[key]) {\r\n        prevValue = node[key];\r\n    }\r\n\r\n    if (nextValue === prevValue) return;\r\n\r\n    if (\r\n        key[0] == \"o\" &&\r\n        key[1] == \"n\" &&\r\n        (isFunction(nextValue) || isFunction(prevValue))\r\n    ) {\r\n        setEvent(node, key, nextValue, handlers);\r\n        return;\r\n    }\r\n\r\n    switch (key) {\r\n        /**\r\n         * add support {@link https://developer.mozilla.org/es/docs/Web/API/CSSStyleSheet}\r\n         */\r\n        case \"styleSheet\":\r\n            if (SUPPORT_STYLE_SHEET)\r\n                node.shadowRoot.adoptedStyleSheets = []\r\n                    .concat(nextValue)\r\n                    .map(cssText => {\r\n                        if (cssText instanceof CSSStyleSheet) {\r\n                            return cssText;\r\n                        }\r\n                        if (!CACHE_STYLE_SHEET[cssText]) {\r\n                            CACHE_STYLE_SHEET[cssText] = new CSSStyleSheet();\r\n                            CACHE_STYLE_SHEET[cssText].replace(cssText);\r\n                        }\r\n\r\n                        return CACHE_STYLE_SHEET[cssText];\r\n                    });\r\n\r\n            break;\r\n        case \"ref\":\r\n            if (nextValue) nextValue.current = node;\r\n            break;\r\n        case \"style\":\r\n            setStyle(node, prevValue || \"\", nextValue || \"\");\r\n            break;\r\n        case \"key\":\r\n            node[KEY] = nextValue;\r\n            break;\r\n        default:\r\n            if (!isSvg && key != \"list\" && key in node) {\r\n                node[key] = nextValue == null ? \"\" : nextValue;\r\n            } else if (nextValue == null) {\r\n                node.removeAttribute(key);\r\n            } else {\r\n                node.setAttribute(\r\n                    key,\r\n                    typeof nextValue == \"object\"\r\n                        ? JSON.stringify(nextValue)\r\n                        : nextValue\r\n                );\r\n            }\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param {import(\"./render\").HTMLNode} node\r\n * @param {string} type\r\n * @param {function} [nextHandler]\r\n * @param {object} handlers\r\n */\r\nexport function setEvent(node, type, nextHandler, handlers) {\r\n    // get the name of the event to use\r\n    type = type.slice(type[2] == \"-\" ? 3 : 2);\r\n    // add handleEvent to handlers\r\n    if (!handlers.handleEvent) {\r\n        /**\r\n         * {@link https://developer.mozilla.org/es/docs/Web/API/EventTarget/addEventListener#The_value_of_this_within_the_handler}\r\n         **/\r\n        handlers.handleEvent = event => handlers[event.type].call(node, event);\r\n    }\r\n    if (nextHandler) {\r\n        // create the subscriber if it does not exist\r\n        if (!handlers[type]) {\r\n            node.addEventListener(type, handlers);\r\n        }\r\n        // update the associated event\r\n        handlers[type] = nextHandler;\r\n    } else {\r\n        // \tdelete the associated event\r\n        if (handlers[type]) {\r\n            node.removeEventListener(type, handlers);\r\n            delete handlers[type];\r\n        }\r\n    }\r\n}\r\n/**\r\n * define style as string inline,this generates less mutation\r\n * to the sun and cleans the previously defined properties.\r\n * @param {import(\"./render\").HTMLNode} node\r\n * @param {(string|object)} prevValue\r\n * @param {(string|object)} nextValue\r\n */\r\nfunction setStyle(node, prevValue, nextValue) {\r\n    let style = node.style,\r\n        prevIsObject;\r\n    if (typeof prevValue == \"object\") {\r\n        prevIsObject = true;\r\n        for (let key in prevValue) {\r\n            if (!(key in nextValue)) setPropertyStyle(style, key, null);\r\n        }\r\n    }\r\n    if (typeof nextValue == \"object\") {\r\n        for (let key in nextValue) {\r\n            let value = nextValue[key];\r\n            if (prevIsObject && prevValue[key] === value) continue;\r\n            setPropertyStyle(style, key, value);\r\n        }\r\n    } else {\r\n        style.cssText = nextValue;\r\n    }\r\n}\r\n\r\nfunction setPropertyStyle(style, key, value) {\r\n    let method = \"setProperty\";\r\n    if (value == null) {\r\n        method = \"removeProperty\";\r\n        value = null;\r\n    }\r\n    if (~key.indexOf(\"-\")) {\r\n        style[method](key, value);\r\n    } else {\r\n        style[key] = value;\r\n    }\r\n}\r\n","import {\r\n    SUPPORT_STYLE_SHEET,\r\n    META_STYLE_SHEET,\r\n    META_MAP_CHILDREN,\r\n    STYLE_SHEET_KEY,\r\n    META_KEYES\r\n} from \"./constants\";\r\n\r\nimport { isArray, isFunction } from \"./utils\";\r\n\r\nlet vNodeEmpty = createElement(null, { children: \"\" });\r\n\r\n/**\r\n * @param {VnodeType} nodeType\r\n * @param {VnodeProps} [props]\r\n * @param {Vnode|Vnode[]} [children]\r\n * @returns {Vnode}\r\n **/\r\nexport function createElement(nodeType, props, ...children) {\r\n    let vnode = { children, ...props, nodeType: nodeType || null };\r\n    return vnode;\r\n}\r\n/**\r\n * toVnode, processes the object for correct use within the diff process.\r\n **/\r\nexport function toVnode(value) {\r\n    if (isVnodeValue(value)) {\r\n        return value;\r\n    } else {\r\n        if (!value[META_MAP_CHILDREN]) {\r\n            let scan = mapChildren(value.children);\r\n            value.children = scan.children;\r\n            if (scan.keyes) {\r\n                value[META_KEYES] = scan.keyes;\r\n            }\r\n            value[META_MAP_CHILDREN] = true;\r\n        }\r\n        if (value.styleSheet && !SUPPORT_STYLE_SHEET) {\r\n            if (!value[META_STYLE_SHEET]) {\r\n                value.children.unshift(\r\n                    toVnode(\r\n                        createElement(\r\n                            \"style\",\r\n                            value[META_KEYES] ? { key: STYLE_SHEET_KEY } : {},\r\n                            value.styleSheet\r\n                        )\r\n                    )\r\n                );\r\n                if (value[META_KEYES]) {\r\n                    value[META_KEYES].unshift(STYLE_SHEET_KEY);\r\n                }\r\n            }\r\n            value[META_STYLE_SHEET] = true;\r\n        }\r\n    }\r\n    return value;\r\n}\r\n\r\nfunction mapChildren(children, scan = { children: [] }, deep = 0) {\r\n    if (isArray(children)) {\r\n        let length = children.length;\r\n        for (let i = 0; i < length; i++) {\r\n            mapChildren(children[i], scan, deep + 1);\r\n        }\r\n    } else {\r\n        if (children == null && !deep) return scan;\r\n\r\n        let vnode = toVnode(children);\r\n\r\n        if (vnode != null && typeof vnode == \"object\") {\r\n            if (isFunction(vnode.nodeType)) {\r\n                let { nodeType, ...props } = vnode;\r\n                return mapChildren(nodeType(props), scan, deep + 1);\r\n            }\r\n            if (\"key\" in vnode) {\r\n                scan.keyes = scan.keyes || [];\r\n                if (!~scan.keyes.indexOf(vnode.key)) {\r\n                    scan.keyes.push(vnode.key);\r\n                }\r\n            }\r\n        }\r\n\r\n        scan.children.push(vnode);\r\n    }\r\n    return scan;\r\n}\r\n\r\nexport function isVnodeEmpty(value) {\r\n    let type = typeof value;\r\n    return value == null || type == \"boolean\" || type == \"function\";\r\n}\r\n\r\nexport function fillVnodeValue(value) {\r\n    return isVnodeEmpty(value)\r\n        ? vNodeEmpty\r\n        : createElement(null, { children: \"\" + value });\r\n}\r\n\r\nexport function isVnodeValue(value) {\r\n    let type = typeof value;\r\n    return (\r\n        value == null ||\r\n        type == \"string\" ||\r\n        type == \"number\" ||\r\n        type == \"function\" ||\r\n        type == \"boolean\"\r\n    );\r\n}\r\n\r\n/**\r\n * @typedef {(Object<string,any>)} VnodeProps;\r\n *\r\n * @typedef {(Function|string)} VnodeType;\r\n *\r\n * @typedef {{type:VnodeType,props:VnodeProps}} Vnode\r\n **/\r\n","import { KEY, META_KEYES, NODE_TYPE, NODE_HOST } from \"../constants\";\r\nimport { diffProps } from \"./diff-props\";\r\nimport { isVnodeValue, fillVnodeValue } from \"../vnode\";\r\n/**\r\n *\r\n * @param {import(\"./render\").ConfigRender} config\r\n * @param {import(\"./render\").HTMLNode} node\r\n * @param {import(\"./vnode\").Vnode} nextVnode\r\n * @param {boolean} isSvg\r\n * @param {Function} currentUpdateComponent\r\n * @return {import(\"./render\").HTMLNode}\r\n **/\r\nexport function diff(id, node, nextVnode, isSvg) {\r\n    let { vnode, handlers = {} } = (node && node[id]) || {};\r\n\r\n    if (vnode == nextVnode && vnode != null) return node;\r\n\r\n    nextVnode = isVnodeValue(nextVnode) ? fillVnodeValue(nextVnode) : nextVnode;\r\n\r\n    let { nodeType, shadowDom, children, ...props } = vnode || {};\r\n\r\n    let {\r\n        nodeType: nextNodeType,\r\n        shadowDom: nextShadowDom,\r\n        children: nextChildren,\r\n        ...nextProps\r\n    } = nextVnode;\r\n\r\n    isSvg = isSvg || nextNodeType == \"svg\";\r\n\r\n    if (nextNodeType != NODE_HOST && getNodeName(node) !== nextNodeType) {\r\n        let nextNode = createNode(nextNodeType, isSvg);\r\n        let parent = node && node.parentNode;\r\n\r\n        if (parent) {\r\n            parent.replaceChild(nextNode, node);\r\n        }\r\n\r\n        node = nextNode;\r\n        handlers = {};\r\n    }\r\n    if(nextNodeType == \"style\"){\r\n        nextNodeType = null;\r\n        nextChildren = nextChildren.join(\"\");\r\n    }\r\n    if (nextNodeType == null) {\r\n        if (node.textContent != nextChildren) {\r\n            node.textContent = nextChildren;\r\n        }\r\n    } else {\r\n        if (shadowDom != nextShadowDom) {\r\n            let { shadowRoot } = node;\r\n            let mode =\r\n                nextShadowDom && !shadowRoot\r\n                    ? \"open\"\r\n                    : !nextShadowDom && shadowRoot\r\n                    ? \"closed\"\r\n                    : 0;\r\n            if (mode) node.attachShadow({ mode });\r\n        }\r\n\r\n        let ignoreChildren = diffProps(\r\n            node,\r\n            props,\r\n            nextProps,\r\n            isSvg,\r\n            handlers,\r\n            id\r\n        );\r\n        if (!ignoreChildren && children != nextChildren) {\r\n            diffChildren(\r\n                id,\r\n                nextShadowDom ? node.shadowRoot : node,\r\n                nextChildren,\r\n                nextProps[META_KEYES],\r\n                isSvg\r\n            );\r\n        }\r\n    }\r\n    node[id] = { vnode: nextVnode, handlers };\r\n    return node;\r\n}\r\n/**\r\n *\r\n * @param {import(\"./render\").ConfigRender} config\r\n * @param {import(\"./render\").HTMLNode} parent\r\n * @param {import(\"./vnode\").Vnode[]} [nextChildren]\r\n * @param {boolean} isSvg\r\n */\r\nexport function diffChildren(id, parent, children, keyes, isSvg) {\r\n    let childrenLenght = children.length;\r\n    let { childNodes } = parent;\r\n    let childNodesKeyes = {};\r\n    let childNodesLength = childNodes.length;\r\n    let index = keyes\r\n        ? 0\r\n        : childNodesLength > childrenLenght\r\n        ? childrenLenght\r\n        : childNodesLength;\r\n\r\n    for (; index < childNodesLength; index++) {\r\n        let childNode = childNodes[index];\r\n        let key = index;\r\n        if (keyes) {\r\n            key = childNode[KEY];\r\n            if (keyes.indexOf(key) > -1) {\r\n                childNodesKeyes[key] = childNode;\r\n                continue;\r\n            }\r\n        }\r\n        index--;\r\n        childNodesLength--;\r\n        parent.removeChild(childNode);\r\n    }\r\n    for (let i = 0; i < childrenLenght; i++) {\r\n        let child = children[i];\r\n        let indexChildNode = childNodes[i];\r\n        let key = keyes ? child.key : i;\r\n        let childNode = keyes ? childNodesKeyes[key] : indexChildNode;\r\n\r\n        if (keyes && childNode) {\r\n            if (childNode != indexChildNode) {\r\n                parent.insertBefore(childNode, indexChildNode);\r\n            }\r\n        }\r\n\r\n        let nextChildNode = diff(id, childNode, child, isSvg);\r\n\r\n        if (!childNode) {\r\n            if (childNodes[i]) {\r\n                parent.insertBefore(nextChildNode, childNodes[i]);\r\n            } else {\r\n                parent.appendChild(nextChildNode);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} type\r\n * @param {boolean} isSvg\r\n * @returns {import(\"./render\").HTMLNode}\r\n */\r\nexport function createNode(type, isSvg) {\r\n    let doc = document;\r\n    let nextNode;\r\n    if (type != null) {\r\n        nextNode = isSvg\r\n            ? doc.createElementNS(\"http://www.w3.org/2000/svg\", type)\r\n            : doc.createElement(type);\r\n    } else {\r\n        nextNode = doc.createTextNode(\"\");\r\n    }\r\n    return nextNode;\r\n}\r\n\r\n/**\r\n * returns the localName of the node\r\n * @param {import(\"./render\").HTMLNode} node\r\n */\r\nexport function getNodeName(node) {\r\n    if (!node) return;\r\n    if (!node[NODE_TYPE]) {\r\n        node[NODE_TYPE] = node.nodeName.toLowerCase();\r\n    }\r\n    let localName = node[NODE_TYPE];\r\n    return localName == \"#text\" ? null : localName;\r\n}\r\n","import { diff } from \"./diff\";\r\nimport { toVnode, createElement } from \"../vnode\";\r\nimport { NODE_HOST } from \"../constants\";\r\n\r\nexport function render(vnode, node, id = \"vnode\") {\r\n    if (\r\n        vnode != null &&\r\n        typeof vnode == \"object\" &&\r\n        vnode.nodeType != NODE_HOST\r\n    ) {\r\n        vnode = createElement(NODE_HOST, { children: vnode });\r\n    }\r\n    vnode = toVnode(vnode);\r\n    diff(id, node, vnode);\r\n    return node;\r\n}\r\n","import { ELEMENT_TRUE_VALUES } from \"../constants\";\r\n\r\nexport function setAttr(node, attr, value) {\r\n    if (value == null) {\r\n        node.removeAttribute(attr);\r\n    } else {\r\n        node.setAttribute(\r\n            attr,\r\n            typeof value == \"object\" ? JSON.stringify(value) : value\r\n        );\r\n    }\r\n}\r\n\r\nexport function formatType(value, type = String) {\r\n    try {\r\n        if (type == Boolean) {\r\n            value = ELEMENT_TRUE_VALUES.indexOf(value) > -1;\r\n        } else if (typeof value == \"string\") {\r\n            value =\r\n                type == Number\r\n                    ? Number(value)\r\n                    : type == Object || type == Array\r\n                    ? JSON.parse(value)\r\n                    : type == Date\r\n                    ? new Date(value)\r\n                    : value;\r\n        }\r\n        if ({}.toString.call(value) == `[object ${type.name}]`) {\r\n            return { value, error: type == Number && Number.isNaN(value) };\r\n        }\r\n    } catch (e) {}\r\n\r\n    return { value, error: true };\r\n}\r\n\r\nexport function propToAttr(prop) {\r\n    return prop.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n}\r\n\r\nexport function attrToProp(attr) {\r\n    return attr.replace(/-(\\w)/g, (all, letter) => letter.toUpperCase());\r\n}\r\n\r\nexport function dispatchEvent(node, type, customEventInit) {\r\n    node.dispatchEvent(\r\n        new CustomEvent(\r\n            type,\r\n            typeof customEventInit == \"object\" ? customEventInit : null\r\n        )\r\n    );\r\n}\r\n","let defer = Promise.resolve();\r\nlet queue = [];\r\nlet running;\r\n\r\nlet maxFps = 1000 / 60;\r\n\r\nexport const IMPORTANT = Symbol(\"important\");\r\n\r\nexport function clearQueue() {\r\n    let time = performance.now();\r\n\r\n    let length = queue.length;\r\n    let current = queue;\r\n\r\n    queue = [];\r\n\r\n    while (length--) {\r\n        let callback = current[length];\r\n        if (callback[IMPORTANT] || performance.now() - time < maxFps) {\r\n            callback();\r\n        } else {\r\n            queue = queue.concat(current.slice(0, length + 1));\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (queue.length) {\r\n        requestAnimationFrame(clearQueue);\r\n        return;\r\n    }\r\n    running = false;\r\n}\r\n/**\r\n * add a task to the queue\r\n * @param {Function} callback\r\n * @returns {Promise} Generate a promise that show  if the queue is complete\r\n */\r\nexport function addQueue(callback) {\r\n    if (!running) {\r\n        running = true;\r\n        defer.then(clearQueue);\r\n    }\r\n    if (!queue.includes(callback)) queue.push(callback);\r\n}\r\n","import { ELEMENT_PROPS, ELEMENT_IGNORE_ATTR } from \"../constants\";\r\nimport { createHookCollection } from \"../hooks\";\r\nimport { render } from \"../render/render\";\r\nimport {\r\n    formatType,\r\n    setAttr,\r\n    propToAttr,\r\n    attrToProp,\r\n    dispatchEvent\r\n} from \"./utils\";\r\n\r\nimport { isFunction, promise } from \"../utils\";\r\nimport { createElement } from \"../vnode\";\r\nimport { addQueue, IMPORTANT } from \"../task\";\r\n\r\nfunction load(self) {\r\n    if (self.mount) return;\r\n\r\n    let id = Symbol(\"vnode\");\r\n\r\n    let isPrevent;\r\n    let isUnmount;\r\n\r\n    self[ELEMENT_PROPS] = {};\r\n\r\n    let isMounted;\r\n\r\n    let resolveUpdate;\r\n\r\n    let rerender = () => {\r\n        // disables blocking, allowing the cycle to be regenerate\r\n        isPrevent = false;\r\n        // After the first render it disables the important condition\r\n        if (rerender[IMPORTANT]) rerender[IMPORTANT] = false;\r\n        try {\r\n            render(\r\n                hooks.load(self.render, { ...self[ELEMENT_PROPS] }),\r\n                self,\r\n                id\r\n            );\r\n\r\n            resolveUpdate();\r\n        } catch (e) {\r\n            self.error(e);\r\n        }\r\n    };\r\n    // mark the first render as important, self speeds up the rendering\r\n    rerender[IMPORTANT] = true;\r\n\r\n    self.update = () => {\r\n        if (isUnmount) return;\r\n        let rendered = self.rendered;\r\n        if (!isPrevent) {\r\n            isPrevent = true;\r\n            // create a promise to observe the status of the update\r\n            rendered = promise(resolve => (resolveUpdate = resolve)).then(\r\n                // the UPDATED state is only propagated through\r\n                // the resolution of the promise\r\n                // Why? ... to improve communication between web-component parent and children\r\n                hooks.updated\r\n            );\r\n\r\n            // if the component is already mounted, avoid using self.mounted,\r\n            // to speed up the microtask\r\n            isMounted\r\n                ? addQueue(rerender)\r\n                : self.mounted.then(() => {\r\n                      isMounted = true;\r\n                      addQueue(rerender);\r\n                  });\r\n        }\r\n\r\n        return (self.rendered = rendered);\r\n    };\r\n\r\n    // any update from hook is added to a separate queue\r\n    let hooks = createHookCollection(() => addQueue(self.update), self);\r\n\r\n    // creates a collection of microtask\r\n    // associated with the mounted of the component\r\n\r\n    self.mounted = promise(\r\n        resolve =>\r\n            (self.mount = () => {\r\n                isMounted = false;\r\n                // allows the reuse of the component when it is isUnmounted and mounted\r\n                if (isUnmount == true) {\r\n                    isUnmount = false;\r\n                    self.mounted = self.update();\r\n                }\r\n                resolve();\r\n            })\r\n    );\r\n    /**\r\n     * creates a collection of microtask\r\n     * associated with the unmounted of the component\r\n     */\r\n    self.unmounted = promise(\r\n        resolve =>\r\n            (self.unmount = () => {\r\n                isUnmount = true;\r\n                hooks.unmount();\r\n                resolve();\r\n            })\r\n    );\r\n\r\n    self.initialize();\r\n\r\n    self.update();\r\n}\r\n\r\nclass AtomicoElement extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        /**\r\n         * identifier to store the virtual-dom state,\r\n         * this is unique between instances of the\r\n         * component to securely consider the host status\r\n         */\r\n        load(this);\r\n    }\r\n    connectedCallback() {\r\n        load(this);\r\n        this.mount();\r\n    }\r\n    disconnectedCallback() {\r\n        this.unmount();\r\n    }\r\n    attributeChangedCallback(attr, oldValue, value) {\r\n        if (attr === this[ELEMENT_IGNORE_ATTR] || oldValue === value) return;\r\n        this[attrToProp(attr)] = value;\r\n    }\r\n}\r\n\r\n/**\r\n * register the component, be it a class or function\r\n * @param {string} nodeType\r\n * @param {Function} component\r\n * @return {Function} returns a jsx component\r\n */\r\nexport function customElement(nodeType, component) {\r\n    if (isFunction(nodeType)) {\r\n        component = nodeType;\r\n\r\n        let CustomElement = class extends AtomicoElement {};\r\n        let prototype = CustomElement.prototype;\r\n\r\n        let props = component.props;\r\n\r\n        prototype.error = component.error || console.error;\r\n        prototype.render = component;\r\n\r\n        prototype.initialize = function() {\r\n            let length = initialize.length;\r\n            while (length--) initialize[length](this);\r\n        };\r\n\r\n        let initialize = [];\r\n\r\n        let attrs = [];\r\n\r\n        for (let prop in props)\r\n            setProperty(prototype, initialize, attrs, prop, props[prop]);\r\n\r\n        CustomElement.observedAttributes = attrs;\r\n\r\n        return CustomElement;\r\n    } else {\r\n        customElements.define(\r\n            nodeType,\r\n            component instanceof Element ? component : customElement(component)\r\n        );\r\n\r\n        return props => createElement(nodeType, props);\r\n    }\r\n}\r\n\r\nfunction setProperty(prototype, initialize, attrs, prop, schema) {\r\n    let attr = propToAttr(prop);\r\n\r\n    schema = schema.name ? { type: schema } : schema;\r\n\r\n    if (prop in prototype) return;\r\n\r\n    function set(nextValue) {\r\n        let prevValue = this[ELEMENT_PROPS][prop];\r\n\r\n        if (isFunction(nextValue)) {\r\n            nextValue = nextValue(prevValue);\r\n        }\r\n        let { value, error } = formatType(nextValue, schema.type);\r\n\r\n        if (error && value != null) {\r\n            throw `the observable [${prop}] must be of the type [${schema.type.name}]`;\r\n        }\r\n\r\n        if (prevValue == value) return;\r\n\r\n        this[ELEMENT_PROPS][prop] = value;\r\n\r\n        let rendered = this.update();\r\n\r\n        if (schema.event) {\r\n            rendered.then(() =>\r\n                dispatchEvent(this, schema.event.type || prop, schema.event)\r\n            );\r\n        }\r\n\r\n        if (schema.reflect) {\r\n            // the default properties are only reflected once the web-component is mounted\r\n            this.mounted.then(() => {\r\n                this[ELEMENT_IGNORE_ATTR] = attr; //update is prevented\r\n                setAttr(\r\n                    this,\r\n                    attr,\r\n                    schema.type == Boolean && !value ? null : value //\r\n                );\r\n                this[ELEMENT_IGNORE_ATTR] = false; // an upcoming update is allowed\r\n            });\r\n        }\r\n    }\r\n\r\n    function get() {\r\n        return this[ELEMENT_PROPS][prop];\r\n    }\r\n\r\n    Object.defineProperty(prototype, prop, { set, get });\r\n\r\n    if (\"value\" in schema) {\r\n        initialize.push(self => (self[prop] = schema.value));\r\n    }\r\n    attrs.push(attr);\r\n}\r\n","import { h, customElement, useState, useEffect } from \"atomico/src/core/core\";\r\n\r\nconst CustomElement = () => {\r\n  let [state, setState] = useState(0);\r\n\r\n  useEffect(() => {\r\n    let interval = setInterval(() => setState(state => state + 1), 1000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return (\r\n    <host shadowDom>\r\n      <style>{`\r\n        :host{\r\n          font-size:${Math.floor(Math.random() * 100) + 10}px;\r\n        }\r\n      `}</style>\r\n      inside web-component {state + \"\"}\r\n    </host>\r\n  );\r\n};\r\n\r\ncustomElement(\"custom-element\", CustomElement);\r\n"],"names":["HOOK_MOUNT","Symbol","HOOK_MOUNTED","HOOK_UPDATE","HOOK_UPDATED","HOOK_UNMOUNT","HOOK_CURRENT","ELEMENT_PROPS","ELEMENT_IGNORE_ATTR","ELEMENT_TRUE_VALUES","NODE_TYPE","KEY","META_STYLE_SHEET","META_MAP_CHILDREN","META_KEYES","NODE_HOST","IGNORE_CHILDREN","innerHTML","textContent","contenteditable","HYDRATE_PROPS","className","id","checked","value","selected","CACHE_STYLE_SHEET","SUPPORT_STYLE_SHEET","document","STYLE_SHEET_KEY","isArray","Array","isEqualArray","before","after","length","i","isFunction","promise","callback","Promise","update","hook","type","updateAll","hooks","useHook","reducer","initialState","ref","use","useRender","render","createHookCollection","host","mounted","load","updated","unmount","param","index","resolve","state","mount","useState","nextState","useEffect","args","executeEffect","diffProps","node","props","nextProps","isSvg","handlers","key","setProperty","ignoreChildren","prevValue","nextValue","setEvent","shadowRoot","adoptedStyleSheets","concat","map","cssText","CSSStyleSheet","replace","current","setStyle","removeAttribute","setAttribute","JSON","stringify","nextHandler","slice","handleEvent","event","call","addEventListener","removeEventListener","style","prevIsObject","setPropertyStyle","method","indexOf","vNodeEmpty","createElement","children","nodeType","vnode","toVnode","isVnodeValue","scan","mapChildren","keyes","styleSheet","unshift","deep","push","isVnodeEmpty","fillVnodeValue","diff","nextVnode","shadowDom","nextNodeType","nextShadowDom","nextChildren","getNodeName","nextNode","createNode","parent","parentNode","replaceChild","join","mode","attachShadow","diffChildren","childrenLenght","childNodes","childNodesKeyes","childNodesLength","childNode","removeChild","child","indexChildNode","insertBefore","nextChildNode","appendChild","doc","createElementNS","createTextNode","nodeName","toLowerCase","localName","setAttr","attr","formatType","String","Boolean","Number","Object","parse","Date","toString","name","error","isNaN","e","propToAttr","prop","attrToProp","all","letter","toUpperCase","dispatchEvent","customEventInit","CustomEvent","defer","queue","running","maxFps","IMPORTANT","clearQueue","time","performance","now","requestAnimationFrame","addQueue","then","includes","self","isPrevent","isUnmount","isMounted","resolveUpdate","rerender","rendered","unmounted","initialize","AtomicoElement","oldValue","HTMLElement","customElement","component","CustomElement","prototype","console","attrs","observedAttributes","customElements","define","Element","schema","set","reflect","get","defineProperty","setState","interval","setInterval","clearInterval","h","Math","floor","random"],"mappings":"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"}